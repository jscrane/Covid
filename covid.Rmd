---
title: "Covid-19 in Ireland"
output: 
  html_document:
    theme: united
params:
  output_dir: "docs"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Introduction

We perform simple mathematical modelling from government-published data, of recorded cases of Covid-19 in the Republic of Ireland.

For a refresher on exponential growth and epidemics, please see the 3Blue1Brown [video](https://www.youtube.com/watch?v=Kas0tIxDvrg).

## The Data

Data is published daily at an Irish Government [website](https://www.gov.ie/en/news/7e0924-latest-updates-on-covid-19-coronavirus/) and manually entered into a data-file. We use only the daily increases in cases and deaths.

```{r}
d <- read.csv(file="~/src/Covid/data.csv", header=TRUE, sep=",")
d[is.na(d)] <- 0
d$date <- as.Date(d$date)
d$day <- as.integer(d$date - d$date[1])
d$total_cases <- cumsum(d$cases)
d$total_deaths <- cumsum(d$deaths)
t <- tail(d,1)
paste(t$date, "total:", t$total_cases, "cases,", t$total_deaths, "deaths")
```

## Exponential Phase

From the plot below, it is clear that as of 19 March, we are currently in the exponential-growth phase. (An r-squared value of 0.97 indicates a very good fit.)

```{r}
f <- log10(total_cases) ~ date
plot(f, data=d, ylab="log(cases)", main="Recorded cases")
m <- lm(f, data=d)
abline(m)
r2 <- summary(m)$r.squared
dbl <- log10(2)/coef(m)[2]
wx <- 2**(7 / dbl)
legend("bottomright", bty="n", legend=c(paste("r^2:", format(r2, digits=2)), paste("dbl:", format(dbl, digits=2), "days"), paste("wx:", format(wx, digits=2))))
```

The parameter $dbl$ in the plot is the doubling time in days, computed from the best-fit slope (cf. the [rule of 70](https://en.wikipedia.org/wiki/Rule_of_72)). The parameter $wx$ is the weekly growth factor.

We can predict the number of cases at the end of the month and see it is in line with estimates from the government.

```{r}
10**(predict(m, newdata=data.frame(date = as.Date("2020-03-30"))))
```

### Notes
Becoming a statistic on this graph requires time and effort; the steps [are](https://www2.hse.ie/conditions/coronavirus/coronavirus.html):

  * call a GP
  * convince them of symptoms
  * be tested (at test centre, or home)
  * wait for result

It is not clear what the average start-to-finish delay is. The [PCR test](https://en.wikipedia.org/wiki/COVID-19_testing) can take up to 2 days.

Statistics on testing are only published weekly. However, extrapolating the last [figure](https://www.rte.ie/news/coronavirus/2020/0317/1123663-coronavirus-ireland/) of about 4% positive with the latest number of cases gives a rough estimate:

```{r}
t$total_cases * 6636 / 292
```

## Logistic Phase
In the real world, exponentials don't continue indefinitely; after some time, they flatten into a [logistic](https://en.wikipedia.org/wiki/Logistic_function) (sigmoid) [curve](http://www.sci.wsu.edu/math/faculty/hudelson/logisticlesson.html).

```{r}
d$lag.cases = c(NA,head(d$cases, -1))
d$growth = d$cases / d$lag.cases
plot(growth ~ date, data=d)
```

The exponential phase ends when the growth rate slows to 1. (However this is not currently the case: the data is too noisy.)